digraph G {
graph [ fontsize=11 ];
node [ fontsize=11 ];
edge [ fontsize=10 ];
rankdir=BU
ranksep=1.5
nodesep=1
splines=spline
compound=true
Graphinfo [ label="" shape=plaintext, style=rounded, color=black, fontname="Arial-Bold" ];
subgraph cluster_1 { label="epoch 1"; fontsize=14; 
subgraph cluster_1_nodes { label="nodes "; peripheries=0;
Quantize_1 ;  }

subgraph cluster_dma_1_in { label=""; peripheries=0;
dummy_1[ style=invis ];  };
 }
subgraph cluster_2 { label="epoch 2"; fontsize=14; 
subgraph cluster_2_nodes { label="nodes "; peripheries=0;
Gemm_3_reshape_x_2 ;  }

subgraph cluster_dma_2_in { label=""; peripheries=0;
dummy_2[ style=invis ];  };
 }
Quantize_1:s -> dummy_2:n [ltail="cluster_1" lhead=cluster_2 strength=1000 penwidth=5];
subgraph cluster_3 { label="epoch 3"; fontsize=14; 
subgraph cluster_3_nodes { label="nodes "; peripheries=0;
Gemm_3_conv_4 ; Gemm_3_conv_4_mul_scale_9 ; Gemm_3_conv_4_off_bias_12 ; Gemm_3_squeeze_y_5 ;  }

subgraph cluster_dma_3_in { label="dma inputs "; peripheries=0;
dma_5i3 ; dma_1i3 ;  };

subgraph cluster_dma_3_out { label="dma outputs "; peripheries=0;
dma_0i3 ;  }
 }
Gemm_3_reshape_x_2:s -> dma_5i3:n [ltail="cluster_2" lhead=cluster_3 strength=1000 penwidth=5];
subgraph cluster_4 { label="epoch 4"; fontsize=14; 
subgraph cluster_4_nodes { label="nodes "; peripheries=0;
__NN__RETURN__ ;  }

subgraph cluster_dma_4_in { label=""; peripheries=0;
dummy_4[ style=invis ];  };
 }
dma_0i3:s -> dummy_4:n [ltail="cluster_3" lhead=cluster_4 strength=1000 penwidth=5];
Gemm_3_weights_transposed_3 [ label="{ { <i0> 0} |  [12]\lGemm_3_weights_transposed_3\l(bytes=128 , 87% of total)\l\l 0.835998 0.917378 0.517875 0.155362 ... | { <o0> 0} }", shape=record, fillcolor="aliceblue", style="rounded,filled"  ] ;
Quantize_1_y_zero_point [ label="{ { <i0> 0} |  [1]\lQuantize_1_y_zero_point\l 1 | { <o0> 0} }", shape=record, fillcolor="aliceblue", style="rounded,filled"  ] ;
Gemm_3_conv_4_off_bias_14 [ label="{ { <i0> 0} |  [16]\lGemm_3_conv_4_off_bias_14\l(bytes=2 , 1.4% of total)\l\l 0 | { <o0> 0} }", shape=record, fillcolor="aliceblue", style="rounded,filled"  ] ;
Input_0_out_0 [ label="{ { <i0> 0} |  [2]\lInput_0_out_0 | { <o0> 0} }", shape=record, fillcolor="aliceblue", style="rounded,filled"  ] ;
Gemm_3_conv_4_mul_scale_11 [ label="{ { <i0> 0} |  [14]\lGemm_3_conv_4_mul_scale_11\l(bytes=16 , 11% of total)\l\l 5.4912e-05 5.77126e-05 5.23317e-05 5.74845e-05 ... | { <o0> 0} }", shape=record, fillcolor="aliceblue", style="rounded,filled"  ] ;
Quantize_1_y_scale [ label="{ { <i0> 0} |  [0]\lQuantize_1_y_scale\l 0.00742233 | { <o0> 0} }", shape=record, fillcolor="aliceblue", style="rounded,filled"  ] ;
Quantize_1 [ label="{ { < i0>  0 M  | < i1>  1 M  | < i2>  2 M } | id=[3] tid=[6]\lQuantize_1\lkind=QuantizeLinear\llatency = 18 cycles\lsched epoch=1.\lsched unit= PROCESSOR 0\l | { < o0>  0 M } }", shape=record, fillcolor="aquamarine", style="rounded,filled"  ] ;
Gemm_3_reshape_x_2 [ label="{ { < i0>  0 M } | id=[9] tid=[7]\lGemm_3_reshape_x_2\lkind=Reshape\lsched epoch=2.\lhw unit=NULL_UNIT\l | { < o0>  0 M } }", shape=record, fillcolor="burlywood1", style="rounded,filled"  ] ;
dma_1i3 [ label="Dma in\nepoch=3.\nmem=8-> sw=8
 axi port=0\nSTREAM_ENG_V2 1", shape=ellipse, width=0.1, fillcolor="cadetblue1", style="rounded,filled"  ]
dma_5i3 [ label="Dma in\nepoch=3.\nmem=8-> sw=8
 axi port=1\nSTREAM_ENG_V2 5", shape=ellipse, width=0.1, fillcolor="cadetblue1", style="rounded,filled"  ]
Gemm_3_conv_4 [ label="{ { < i0>  0 M (no clone)  | < i1>  1 M } | id=[13] tid=[8]\lGemm_3_conv_4\lkind=Conv\lNUM_OPS = 256 OPS( 1e+02% of total )\llatency = 128 cycles\lOPS/cycle = 2\lsched epoch=3.\lsched unit= CONV_ACC_V2 0\lconv mode=K outer, F inner\lchoked ports=( weights  )\lshifts: f=0 a=3 o=3\lsimd mode:16x8\lunit max power % 35\lkernel_shape is 1 1\lgroup i 1\lstrides is 1 1\lpads is 0 0 0 0\ldilations is 1 1\lConv_fsub f 1\lpad_constant_value f 0\l | { < o0>  0 S } }", shape=record, fillcolor="cadetblue1", style="rounded,filled"  ] ;
Gemm_3_conv_4_mul_scale_9 [ label="{ { < i0>  0 S  | < i1>  1 P } | id=[15] tid=[9]\lGemm_3_conv_4_mul_scale_9\lkind=Mul\lNUM_OPS = 16 OPS\llatency = 16 cycles\lOPS/cycle = 1\lsched epoch=3.\lsched unit= ARITH_ACC_V2 0\lA=1 B=0 C=0\lshifts: x=0 y=0 AX_RS=0 BY_RS=0 C_LS=0 o=15\lunit max power % 100\l | { < o0>  0 S } }", shape=record, fillcolor="cadetblue1", style="rounded,filled"  ] ;
dma_0i3 [ label="Dma out\nepoch=3.\nsw=16-> mem=16
 axi port=0\nSTREAM_ENG_V2 0", shape=ellipse, width=0.1, fillcolor="cadetblue1", style="rounded,filled"  ]
Gemm_3_conv_4_off_bias_12:o0:s->dma_0i3:n [ label="edge id=[17]\ltid=121 122\lbatch: 16(in) 16(out,L) 0(mem,L) \l1x16x1x1\lbits=8\lin=out: (S8)\lscale=(0.0236586, )\loffset=(20, )\lGemm_3_conv_4_off_bias_out_13 FLOAT( 1 16 1 1 )\lGemm_3_conv_4_off_bias_out_13 live(3, 4, id=10)\lpool=1[0, 16]=16 B\lnpuRAM5 edge bs=16\l context[0](1,0)\lout bw=16 B\l" ]; 
Gemm_3_conv_4_off_bias_12 [ label="{ { < i0>  0 S  | < i1>  1 P } | id=[17] tid=[10]\lGemm_3_conv_4_off_bias_12\lkind=Add\lNUM_OPS = 16 OPS\llatency = 16 cycles\lOPS/cycle = 1\lsched epoch=3.\lsched unit= ARITH_ACC_V2 1\lA=21641 B=320 C=0 B C combined= 20971520\lshifts: x=0 y=0 AX_RS=0 BY_RS=0 C_LS=0 o=20\lunit max power % 35\l | { < o0>  0 M } }", shape=record, fillcolor="cadetblue1", style="rounded,filled"  ] ;
Gemm_3_squeeze_y_5 [ label="{ { < i0>  0 M } | id=[19] tid=[11]\lGemm_3_squeeze_y_5\lkind=Reshape\lsched epoch=3.\lhw unit=NULL_UNIT\l | { < o0>  0 M } }", shape=record, fillcolor="cadetblue1", style="rounded,filled"  ] ;
__NN__RETURN__ [ label="{ { < i0>  0 M } | id=[23] tid=[12]\l__NN__RETURN__\lkind=Return\lsched epoch=4.\lsched unit= PROCESSOR 0\l}", shape=record, fillcolor="chartreuse", style="rounded,filled"  ] ;
Input_0_out_0:o0:s->Quantize_1:i0:n [ label="edge id=[0]\ltid=13 14\lbatch: 0(in,L) 1(out,L) 1(mem,L) \l1x8\lbits=32\lin=out: Float\lInput_0_out_0 FLOAT( 1 8 )\lInput_0_out_0 live(0, 1, id=6)\lpool=1[0, 32]=32 B\lnpuRAM5 edge bs=32\l context[0](1,0)\lout bw=?\l" ]; 
Quantize_1_y_scale:o0:s->Quantize_1:i1:n [ label="edge id=[1]\ltid=17 18\lbatch: 0(in,L) 0(mem,L) \l1\lbits=32\lin=out: Float\lQuantize_1_y_scale FLOAT( )\lQuantize_1_y_scale live(0, inf, id=1)\lpool=7[160, 164]=4 B\loctoFlash edge bs=4\l context[0](1,0)\lout bw=?\l" ]; 
Quantize_1_y_zero_point:o0:s->Quantize_1:i2:n [ label="edge id=[2]\ltid=21 22\lbatch: 0(in,L) 0(mem,L) \l1\lbits=8\lin=out: No format info\lQuantize_1_y_zero_point INT8( )\lQuantize_1_y_zero_point live(0, inf, id=5)\lpool=7[192, 193]=1 B\loctoFlash edge bs=1\l context[0](1,0)\lout bw=?\l" ]; 
Gemm_3_weights_transposed_3:o0:s->dma_5i3:n [ penwidth=2, style=dashed  ]; 
dma_5i3:s->Gemm_3_conv_4:i1:n [ label="cloned=0\ledge id=[12]\ltid=86 87\lbatch: 8(in,L) 8(out,L) 8(mem,L) \l16(nkern) \l16x8x1x1\lbits=8\lin=out: (S8)\lscale=(0.00739821, 0.00777553, 0.00705058, 0.0077448, 0.00655379, 0.00763669, 0.00768419, 0.00782014, 0.00783833, 0.00700513, \l0.00742785, 0.00576258, 0.00678008, 0.00754179, 0.00678006, 0.00709008, )\loffset=(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \l0, 0, 0, 0, 0, 0, )\lGemm_3_weights_transposed_3 FLOAT( 16 8 1 1 )\lGemm_3_weights_transposed_3 live(0, inf, id=3)\lpool=7[0, 128]=128 B\loctoFlash edge bs=128\l context[0](1,0)\lin bw=128 B\lis cache path\l"   ]; 
Gemm_3_conv_4:o0:s->Gemm_3_conv_4_mul_scale_9:i0:n [ label="edge id=[13]\ltid=95 96\lbatch: 16(in) 16(out,L) \l1x16x1x1\lin=out Q[18S.-3]\lin=out: (S8) M=18 N=-3 sign=true\lGemm_3_conv_4 FLOAT( 1 16 1 1 )\lGemm_3_conv_4 live(3, 3, id=8) edge bs=32\l context[0](1,0)\lout bw=?\l" ]; 
Gemm_3_conv_4_mul_scale_11:o0:s->Gemm_3_conv_4_mul_scale_9:i1:n [ label="edge id=[14]\ltid=99 100\lbatch: 16(in,L) 16(out,L) 16(mem,L) \l16x1x1\lin=out Q[-14S.29]\lin=out: (S8) M=-14 N=29 sign=true\lGemm_3_conv_4_mul_scale_11 FLOAT( 16 1 1 )\lGemm_3_conv_4_mul_scale_11 live(0, inf, id=4)\lpool=7[128, 160]=32 B\loctoFlash edge bs=32\l context[0](1,0)\lout bw=?\l" ]; 
Gemm_3_conv_4_mul_scale_9:o0:s->Gemm_3_conv_4_off_bias_12:i0:n [ label="edge id=[15]\ltid=108 109\lbatch: 16(in) 16(out,L) \l1x16x1x1\lin=out Q[4S.11]\lin=out: (S8) M=4 N=11 sign=true\lGemm_3_conv_4_mul_scale_out_10 FLOAT( 1 16 1 1 )\lGemm_3_conv_4_mul_scale_out_10 live(3, 3, id=9) edge bs=32\l context[0](1,0)\lout bw=?\l" ]; 
Gemm_3_conv_4_off_bias_14:o0:s->Gemm_3_conv_4_off_bias_12:i1:n [ label="edge id=[16]\ltid=112 113\l1\lin=out Q[4S.11]\lin=out: (S16) M=4 N=11 sign=true\lGemm_3_conv_4_off_bias_14 FLOAT( 1 )\lGemm_3_conv_4_off_bias_14 live(0, inf, id=2)\lpool=7[176, 178]=2 B\loctoFlash edge bs=2\l context[0](1,0)\lout bw=?\l" ]; 
Gemm_3_conv_4_off_bias_12:o0:s->Gemm_3_squeeze_y_5:i0:n [ label="edge id=[17]\ltid=121 122\lbatch: 16(in) 16(out,L) 0(mem,L) \l1x16x1x1\lbits=8\lin=out: (S8)\lscale=(0.0236586, )\loffset=(20, )\lGemm_3_conv_4_off_bias_out_13 FLOAT( 1 16 1 1 )\lGemm_3_conv_4_off_bias_out_13 live(3, 4, id=10)\lpool=1[0, 16]=16 B\lnpuRAM5 edge bs=16\lout bw=16 B\l" ]; 
Quantize_1:o0:s->Gemm_3_reshape_x_2:i0:n [ label="edge id=[24]\ltid=33 154\lbatch: 0(out,L) 0(mem,L) \l1x8\lbits=8\lin=out: (S8)\lscale=(0.00742233, )\loffset=(1, )\lDequantize_2_out_0 FLOAT( 1 8 )\lQuantize_1_out_0 live(1, 3, id=7)\lpool=1[32, 40]=8 B\lnpuRAM5 edge bs=8\lout bw=8 B\l" ]; 
Gemm_3_reshape_x_2:o0:s->dma_1i3:n [ penwidth=2, style=dashed  ]; 
dma_1i3:s->Gemm_3_conv_4:i0:n [ label="cloned=0\ledge id=[25]\ltid=155 156\lbatch: 8(in,L) 0(out,L) 0(mem,L) \l1x8x1x1\lbits=8\lin=out: (S8)\lscale=(0.00742233, )\loffset=(1, )\lGemm_3_reshape_x_2 FLOAT( 1 8 1 1 )\lGemm_3_reshape_x_2 live(1, 3, id=7)\lpool=1[32, 40]=8 B\lnpuRAM5 edge bs=8\l context[0](1,0)\lin bw=8 B\lbatch depth=8\lbatch iter=1\ltotal iter=1\l"   ]; 
Gemm_3_squeeze_y_5:o0:s->__NN__RETURN__:i0:n [ label="edge id=[26]\ltid=137 152\lbatch: 0(out,L) 0(mem,L) \l1x16\lbits=8\lin=out: (S8)\lscale=(0.0236586, )\loffset=(20, )\lQuantize_4_out_0 INT8( 1 16 )\lQuantize_4_out_0 live(3, 4, id=10)\lpool=1[0, 16]=16 B\lnpuRAM5 edge bs=16\l context[0](1,0)\lout bw=?\l" ]; 
}
