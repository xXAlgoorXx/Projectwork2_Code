digraph G {
graph [ fontsize=11 ];
node [ fontsize=11 ];
edge [ fontsize=10 ];
rankdir=BU
ranksep=1.5
nodesep=1
splines=spline
compound=true
Graphinfo [ label="" shape=plaintext, style=rounded, color=black, fontname="Arial-Bold" ];
subgraph cluster_1 { label="epoch 1"; fontsize=14; 
subgraph cluster_1_nodes { label="nodes "; peripheries=0;
Gemm_2_reshape_x_2 ;  }

subgraph cluster_dma_1_in { label=""; peripheries=0;
dummy_1[ style=invis ];  };
 }
subgraph cluster_2 { label="epoch 2"; fontsize=14; 
subgraph cluster_2_nodes { label="nodes "; peripheries=0;
Gemm_2_conv_4_suboff_6 ;  }

subgraph cluster_dma_2_in { label="dma inputs "; peripheries=0;
dma_0i2 ;  };

subgraph cluster_dma_2_out { label="dma outputs "; peripheries=0;
dma_1i2 ;  }
 }
Gemm_2_reshape_x_2:s -> dma_0i2:n [ltail="cluster_1" lhead=cluster_2 strength=1000 penwidth=5];
subgraph cluster_3 { label="epoch 3"; fontsize=14; 
subgraph cluster_3_nodes { label="nodes "; peripheries=0;
Gemm_2_conv_4 ; Gemm_2_conv_4_mul_scale_9 ; Gemm_2_conv_4_off_bias_12 ; Gemm_2_squeeze_y_5 ;  }

subgraph cluster_dma_3_in { label="dma inputs "; peripheries=0;
dma_3i3 ; dma_2i3 ; dma_4i3 ;  };

subgraph cluster_dma_3_out { label="dma outputs "; peripheries=0;
dma_5i3 ;  }
 }
dma_1i2:s -> dma_3i3:n [ltail="cluster_2" lhead=cluster_3 strength=1000 penwidth=5];
subgraph cluster_4 { label="epoch 4"; fontsize=14; 
subgraph cluster_4_nodes { label="nodes "; peripheries=0;
__NN__RETURN__ ;  }

subgraph cluster_dma_4_in { label=""; peripheries=0;
dummy_4[ style=invis ];  };
 }
dma_5i3:s -> dummy_4:n [ltail="cluster_3" lhead=cluster_4 strength=1000 penwidth=5];
Gemm_2_conv_4_off_bias_14 [ label="{ { <i0> 0} |  [13]\lGemm_2_conv_4_off_bias_14\l(bytes=2 , 0.00019% of total)\l\l 0 | { <o0> 0} }", shape=record, fillcolor="aliceblue", style="rounded,filled"  ] ;
Input_0_out_0 [ label="{ { <i0> 0} |  [2]\lInput_0_out_0 | { <o0> 0} }", shape=record, fillcolor="aliceblue", style="rounded,filled"  ] ;
Gemm_2_weights_transposed_3 [ label="{ { <i0> 0} |  [9]\lGemm_2_weights_transposed_3\l(bytes=1048576 , 1e+02% of total)\l\l 0.926477 0.541754 0.211991 0.196287 ... | { <o0> 0} }", shape=record, fillcolor="aliceblue", style="rounded,filled"  ] ;
Gemm_2_conv_4_mul_scale_11 [ label="{ { <i0> 0} |  [11]\lGemm_2_conv_4_mul_scale_11\l(bytes=1024 , 0.098% of total)\l\l 3.07902e-05 3.08018e-05 3.08782e-05 3.08491e-05 ... | { <o0> 0} }", shape=record, fillcolor="aliceblue", style="rounded,filled"  ] ;
Gemm_2_conv_4_zero_off_8 [ label="{ { <i0> 0} |  [7]\lGemm_2_conv_4_zero_off_8\l(bytes=1 , 9.5e-05% of total)\l\l 0 | { <o0> 0} }", shape=record, fillcolor="aliceblue", style="rounded,filled"  ] ;
Gemm_2_reshape_x_2 [ label="{ { < i0>  0 M } | id=[6] tid=[5]\lGemm_2_reshape_x_2\lkind=Reshape\lsched epoch=1.\lhw unit=NULL_UNIT\l | { < o0>  0 M } }", shape=record, fillcolor="aquamarine", style="rounded,filled"  ] ;
dma_1i2 [ label="Dma out\nepoch=2.\nsw=1024-> mem=1024
 axi port=0\nSTREAM_ENG_V2 1", shape=ellipse, width=0.1, fillcolor="burlywood1", style="rounded,filled"  ]
Gemm_2_conv_4_suboff_6:o0:s->dma_1i2:n [ label="edge id=[8]\ltid=62 63\lbatch: 128(in,L) 1024(out,L) 128(mem,L) \l1x1024x1x1\lbits=8\lin=out: (U8)\lscale=(0.00392157, )\loffset=(0, )\lGemm_2_conv_4_zero_off_out_7 FLOAT( 1 1024 1 1 )\lGemm_2_conv_4_zero_off_out_7 live(2, 3, id=6) edge bs=1024\l context[0](1,0)\lout bw=1.00 KB\l" ]; 
dma_0i2 [ label="Dma in\nepoch=2.\nmem=1024-> sw=1024
 axi port=0\nSTREAM_ENG_V2 0", shape=ellipse, width=0.1, fillcolor="burlywood1", style="rounded,filled"  ]
Gemm_2_conv_4_suboff_6 [ label="{ { < i0>  0 M  | < i1>  1 P } | id=[8] tid=[6]\lGemm_2_conv_4_suboff_6\lkind=Sub\lNUM_OPS = 1.02 KOPS\llatency = 1.02 Kcycles\lOPS/cycle = 1\lsched epoch=2.\lsched unit= ARITH_ACC_V2 0\lA=16384 B=32 C=0 B C combined= 2097152\lshifts: x=0 y=0 AX_RS=0 BY_RS=0 C_LS=0 o=14\lunit max power % 35\l | { < o0>  0 M } }", shape=record, fillcolor="burlywood1", style="rounded,filled"  ] ;
dma_2i3 [ label="Dma in\nepoch=3.\nmem=128-> sw=128
 axi port=0\nSTREAM_ENG_V2 2", shape=ellipse, width=0.1, fillcolor="cadetblue1", style="rounded,filled"  ]
dma_3i3 [ label="Dma in\nepoch=3.\nmem=128-> sw=128
 axi port=0\nSTREAM_ENG_V2 3", shape=ellipse, width=0.1, fillcolor="cadetblue1", style="rounded,filled"  ]
Gemm_2_conv_4 [ label="{ { < i0>  0 M (no clone)  | < i1>  1 M  | < i2>  2 S } | id=[10] tid=[7]\lGemm_2_conv_4\lkind=Conv\lNUM_OPS = 2.10 MOPS( 1e+02% of total )\llatency = 349.53 Kcycles\lOPS/cycle = 6\lsched epoch=3.\lsched unit= CONV_ACC_V2 0\lconv mode=K outer, F inner\lchoked ports=( weights  )\lDeep mode kx3\lshifts: f=0 a=10 o=10\lsimd mode:8x8\lunit max power % 35\lkernel_shape is 1 1\lgroup i 1\lstrides is 1 1\lpads is 0 0 0 0\ldilations is 1 1\l | { < o0>  0 S } }", shape=record, fillcolor="cadetblue1", style="rounded,filled"  ] ;
dma_4i3 [ label="Dma in\nepoch=3.\nmem=16-> sw=16
 axi port=0\nSTREAM_ENG_V2 4", shape=ellipse, width=0.1, fillcolor="cadetblue1", style="rounded,filled"  ]
Gemm_2_conv_4_mul_scale_9 [ label="{ { < i0>  0 S  | < i1>  1 M } | id=[12] tid=[8]\lGemm_2_conv_4_mul_scale_9\lkind=Mul\lNUM_OPS = 1.02 KOPS\llatency = 1.02 Kcycles\lOPS/cycle = 1\lsched epoch=3.\lsched unit= ARITH_ACC_V2 1\lA=1 B=1 C=1\lshifts: x=0 y=0 AX_RS=0 BY_RS=0 C_LS=0 o=14\lunit max power % 35\l | { < o0>  0 S } }", shape=record, fillcolor="cadetblue1", style="rounded,filled"  ] ;
dma_5i3 [ label="Dma out\nepoch=3.\nsw=16-> mem=16
 axi port=1\nSTREAM_ENG_V2 5", shape=ellipse, width=0.1, fillcolor="cadetblue1", style="rounded,filled"  ]
Gemm_2_conv_4_off_bias_12:o0:s->dma_5i3:n [ label="edge id=[14]\ltid=101 102\lbatch: 16(in) 16(out,L) 0(mem,L) \l1x1024x1x1\lbits=8\lin=out: (S8)\lscale=(1.14256, )\loffset=(-128, )\lGemm_2_conv_4_off_bias_out_13 FLOAT( 1 1024 1 1 )\lGemm_2_conv_4_off_bias_out_13 live(3, 4, id=9) edge bs=1024\l context[0](1,0)\lout bw=1.00 KB\l" ]; 
Gemm_2_conv_4_off_bias_12 [ label="{ { < i0>  0 S  | < i1>  1 P } | id=[14] tid=[9]\lGemm_2_conv_4_off_bias_12\lkind=Add\lNUM_OPS = 1.02 KOPS\llatency = 1.02 Kcycles\lOPS/cycle = 1\lsched epoch=3.\lsched unit= ARITH_ACC_V2 2\lA=28679 B=-2048 C=0 B C combined= -134217728\lshifts: x=0 y=0 AX_RS=0 BY_RS=0 C_LS=0 o=20\lunit max power % 35\l | { < o0>  0 M } }", shape=record, fillcolor="cadetblue1", style="rounded,filled"  ] ;
Gemm_2_squeeze_y_5 [ label="{ { < i0>  0 M } | id=[16] tid=[10]\lGemm_2_squeeze_y_5\lkind=Reshape\lsched epoch=3.\lhw unit=NULL_UNIT\l | { < o0>  0 M } }", shape=record, fillcolor="cadetblue1", style="rounded,filled"  ] ;
__NN__RETURN__ [ label="{ { < i0>  0 M } | id=[20] tid=[11]\l__NN__RETURN__\lkind=Return\lsched epoch=4.\lsched unit= PROCESSOR 0\l}", shape=record, fillcolor="chartreuse", style="rounded,filled"  ] ;
Gemm_2_reshape_x_2:o0:s->dma_0i2:n [ penwidth=2, style=dashed  ]; 
dma_0i2:s->Gemm_2_conv_4_suboff_6:i0:n [ label="cloned=0\ledge id=[6]\ltid=49 50\lbatch: 1024(in) 0(out,L) 0(mem,L) \l1x1024x1x1\lbits=8\lin=out: (S8)\lscale=(0.00392157, )\loffset=(-128, )\lGemm_2_reshape_x_2 FLOAT( 1 1024 1 1 )\lGemm_2_reshape_x_2 live(0, 2, id=4) edge bs=1024\l context[0](1,0)\lin bw=1.00 KB\l"   ]; 
Gemm_2_conv_4_zero_off_8:o0:s->Gemm_2_conv_4_suboff_6:i1:n [ label="edge id=[7]\ltid=53 54\l1\lbits=8\lin=out: (S8)\lscale=(0.00392157, )\loffset=(0, )\lGemm_2_conv_4_zero_off_8 FLOAT( 1 )\lGemm_2_conv_4_zero_off_8 live(0, inf, id=5) edge bs=1\l context[0](1,0)\lout bw=?\l" ]; 
dma_1i2:s->dma_2i3:n [ penwidth=2, style=dashed  ]; 
dma_2i3:s->Gemm_2_conv_4:i0:n [ label="cloned=0\ledge id=[8]\ltid=62 63\lbatch: 128(in,L) 1024(out,L) 128(mem,L) \l1x1024x1x1\lbits=8\lin=out: (U8)\lscale=(0.00392157, )\loffset=(0, )\lGemm_2_conv_4_zero_off_out_7 FLOAT( 1 1024 1 1 )\lGemm_2_conv_4_zero_off_out_7 live(2, 3, id=6) edge bs=1024\l context[0](1,0)\lin bw=64.00 KB\lbatch depth=128\lbatch iter=1\ltotal iter=512\l"   ]; 
Gemm_2_weights_transposed_3:o0:s->dma_3i3:n [ penwidth=2, style=dashed  ]; 
dma_3i3:s->Gemm_2_conv_4:i1:n [ label="cloned=0\ledge id=[9]\ltid=66 67\lbatch: 128(in,L) 128(out,L) 128(mem,L) \l16(nkern)  (deep knr=16 nk=8) (pad dim val=1 off=2048)\l1024x1024x1x1\lbits=8\lin=out: (S8)\lscale=(0.0078515, 0.00785447, 0.00787394, 0.00786653, 0.00785557, 0.00786147, 0.00786565, 0.00787066, 0.00785734, 0.00787387, \l0.00786024, 0.00787306, 0.00786792, 0.00785619, 0.00786448, 0.00786849, 0.00785896, 0.007867, 0.00786829, 0.00786858, \l0.00787067, 0.0078592, 0.00786427, 0.00786657, 0.0078736, 0.00787401, 0.00786892, 0.00786241, 0.00786941, 0.0078694, \l0.00785378,  ... )\loffset=(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \l0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \l0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \l0,  ... )\lGemm_2_weights_transposed_3 FLOAT( 1024 1024 1 1 )\lGemm_2_weights_transposed_3 live(0, inf, id=1) edge bs=1049088\l context[0](1,0)\lin bw=1.00 MB\l"   ]; 
Gemm_2_conv_4:o0:s->Gemm_2_conv_4_mul_scale_9:i0:n [ label="edge id=[10]\ltid=135 76\lbatch: 16(in) 16(out,L) 0(mem,L) \l1x1024x1x1\lin=out Q[25S.-10]\lin=out: (S16) M=25 N=-10 sign=true\lGemm_2_conv_4 FLOAT( 1 1024 1 1 )\lGemm_2_conv_4 live(3, 4, id=7) edge bs=2048\l context[0](0,7)\l context[1](1,1)\lout bw=?\l" ]; 
Gemm_2_conv_4_mul_scale_11:o0:s->dma_4i3:n [ penwidth=2, style=dashed  ]; 
dma_4i3:s->Gemm_2_conv_4_mul_scale_9:i1:n [ label="cloned=0\ledge id=[11]\ltid=79 80\lbatch: 16(in,L) 16(out,L) 16(mem,L) \l1024x1x1\lin=out Q[-14S.29]\lin=out: (S8) M=-14 N=29 sign=true\lGemm_2_conv_4_mul_scale_11 FLOAT( 1024 1 1 )\lGemm_2_conv_4_mul_scale_11 live(0, inf, id=2) edge bs=2048\l context[0](1,0)\lin bw=2.00 KB\l"   ]; 
Gemm_2_conv_4_mul_scale_9:o0:s->Gemm_2_conv_4_off_bias_12:i0:n [ label="edge id=[12]\ltid=88 89\lbatch: 16(in) 16(out,L) \l1x1024x1x1\lin=out Q[10S.5]\lin=out: (S8) M=10 N=5 sign=true\lGemm_2_conv_4_mul_scale_out_10 FLOAT( 1 1024 1 1 )\lGemm_2_conv_4_mul_scale_out_10 live(3, 3, id=8) edge bs=2048\l context[0](1,0)\lout bw=?\l" ]; 
Gemm_2_conv_4_off_bias_14:o0:s->Gemm_2_conv_4_off_bias_12:i1:n [ label="edge id=[13]\ltid=92 93\l1\lin=out Q[10S.5]\lin=out: (S16) M=10 N=5 sign=true\lGemm_2_conv_4_off_bias_14 FLOAT( 1 )\lGemm_2_conv_4_off_bias_14 live(0, inf, id=3) edge bs=2\l context[0](1,0)\lout bw=?\l" ]; 
Gemm_2_conv_4_off_bias_12:o0:s->Gemm_2_squeeze_y_5:i0:n [ label="edge id=[14]\ltid=101 102\lbatch: 16(in) 16(out,L) 0(mem,L) \l1x1024x1x1\lbits=8\lin=out: (S8)\lscale=(1.14256, )\loffset=(-128, )\lGemm_2_conv_4_off_bias_out_13 FLOAT( 1 1024 1 1 )\lGemm_2_conv_4_off_bias_out_13 live(3, 4, id=9) edge bs=1024\lout bw=1.00 KB\l" ]; 
Input_0_out_0:o0:s->Gemm_2_reshape_x_2:i0:n [ label="edge id=[21]\ltid=13 134\lbatch: 1(out,L) 1(mem,L) \l1x1024\lbits=8\lin=out: (S8)\lscale=(0.00392157, )\loffset=(-128, )\lDequantize_1_out_0 FLOAT( 1 1024 )\lInput_0_out_0 live(0, 2, id=4) edge bs=1024\lout bw=?\l" ]; 
Gemm_2_conv_4:o0:s->Gemm_2_conv_4:i2:n [ label="edge id=[22]\ltid=135 136\lbatch: 16(in) 16(out,L) 0(mem,L) \l1x1024x1x1\lin=out Q[25S.-10]\lin=out: (S16) M=25 N=-10 sign=true\lAcc input\lGemm_2_conv_4 live(3, 4, id=7) edge bs=32\l context[0](1,0)\lout bw=32 B\l", color=red, penwidth=2  ]; 
Gemm_2_squeeze_y_5:o0:s->__NN__RETURN__:i0:n [ label="edge id=[23]\ltid=117 132\lbatch: 0(out,L) 0(mem,L) \l1x1024\lbits=8\lin=out: (S8)\lscale=(1.14256, )\loffset=(-128, )\lQuantize_3_out_0 INT8( 1 1024 )\lQuantize_3_out_0 live(3, 4, id=9) edge bs=1024\l context[0](1,0)\lout bw=?\l" ]; 
}
